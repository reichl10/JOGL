\documentclass[10pt]{scrreprt}
\usepackage[a4paper, top=30mm, left=25mm, right=25mm, bottom=30mm]{geometry}
\usepackage[utf8]{inputenc}

\usepackage[Bjornstrup]{fncychap}
\usepackage{pdfpages}
\usepackage{ngerman}
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{etoolbox}
\usepackage{wrapfig}
\usepackage{enumitem}
\usepackage{tabu}
\usepackage{amsmath}
\usepackage{url}
\usepackage{numprint}
\usepackage{longtable}
\usepackage{caption}
 \usepackage{rotating}
\usepackage{array}
\usepackage{listings}
\usepackage{amssymb}
\usepackage{multirow}
\usepackage{textcomp}
\usepackage{calc}
\usepackage{doxygen}
\usepackage[table]{xcolor}
%\usepackage{hyperref}
%\hypersetup{%
%  colorlinks=false,%
%  linkcolor=blue,%
%  citecolor=blue,%
%  unicode%
%}
\usepackage{mathptmx}
\usepackage{courier}
\usepackage{amssymb}
\renewcommand{\DoxyLabelFont}{%
  \fontseries{bc}\selectfont%
  \color{darkgray}%
}
% Used for member lists
\renewenvironment{DoxyCompactItemize}{%
  \begin{itemize}%
  \sffamily
    \setlength{\itemsep}{-3pt}%
    \setlength{\parsep}{0pt}%
    \setlength{\topsep}{0pt}%
    \setlength{\partopsep}{0pt}%
}{%
  \end{itemize}%
}

\renewcommand{\em}{\sffamily\bfseries}
\renewcommand{\bf}{\sffamily\bfseries}
\newcommand{\hyperlink}[2]{#1}
\usepackage{colortbl}

\makeatletter
\patchcmd{\@makechapterhead}{\vspace*{50\p@}}{\vspace*{-20\p@}}{}{}
\patchcmd{\@makeschapterhead}{\vspace*{50\p@}}{\vspace*{7\p@}}{}{}
\patchcmd{\DOTIS}{\vskip 40\p@}{\vskip -12\p@} 
\makeatother
  
\captionsetup[figure]{labelfont={sf,bf},textfont={sf}}
\deffootnotemark{[\thefootnotemark]}
\deffootnote{1.5em}{1em}{[\thefootnotemark] }
\setlength{\parindent}{0pt}
\renewcommand{\labelitemi}{ \raisebox{0.3ex}{\small$\blacktriangleright$} }
\renewcommand{\labelitemii}{ \raisebox{0.3ex}{\small$\triangleright$} }
\lstset{language=Java}

\newcommand{\sfbf}[1]{\textbf{\sffamily #1}}
\newcommand{\sfit}[1]{\textit{\sffamily #1}}
\newcommand{\W}{\sfbf{W}}
\newcommand{\ziel}[1]{{\fontsize{9.5}{11}\textsf{/#1/}}}
\newcommand{\ziellabel}{Z}
\newcommand{\muss}{\renewcommand{\labelenumi}{\textbf{\ziel{\ziellabel\numprint{\theenumi}0}}}}
\newcommand{\wunsch}{\renewcommand{\labelenumi}{\textbf{\ziel{\ziellabel\numprint{\theenumi}0W}}}}
\newcommand{\JoglEarth}{\raisebox{-1.2mm}{\includegraphics[scale=0.33]{Logo-Text.eps}} }
\newcommand{\textref}[1]{\mbox{\raisebox{0.1ex}{\small$\rightarrow$ }\textit{#1}}}

\newenvironment{details}[1][6pt]{%
  \parskip#1 \parindent6mm \raggedright%
  \def\item{\par\ignorespaces\hangindent=5mm \hangafter1}}{%
  \par\ignorespaces} 
  
 

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\lstset{ %
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\footnotesize,        % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
  commentstyle=\color{mygreen},    % comment style
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},       % keyword style
  language=Octave,                 % the language of the code
  morekeywords={*,...},            % if you want to add more keywords to the set
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  stepnumber=2,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{mymauve},     % string literal style
  tabsize=2,                       % sets default tabsize to 2 spaces
  title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
}

\begin{document}

\thispagestyle{empty}
\sffamily
 
\title{Spezifikation}

\begin{figure}
\begin{flushright}
	\includegraphics[scale=0.4]{uniLogo.eps}
\vspace{2.0 cm}
\end{flushright}
\end{figure}

\begin{center}
\vspace{2.0 cm}
{\LARGE SEP – Wintersemester 2013/14}

\vspace{1.0 cm}
\textbf{{\Huge Spezifikation}}

\vspace{0.4 cm}
\begin{figure}[!htb]
\begin{center}
	%\includegraphics[scale=1.0]{projektLogo.eps}
	\includegraphics[scale=1.5]{Logo-Print.eps}
\end{center}
\end{figure}

\vspace{0.2 cm}
\textbf{{\huge OpenStreetMap: Die Welt in 3D}}

\vspace{1.5 cm}
29.11.2013

\vspace{0.5 cm}
Version: 1.1

\vspace{1.5 cm}
{\Large Projektbetreuer: Peter Barth}

\vspace{1.5 cm}
\begin{tabular}{|c|c|c|}
\hline 
\rule[-1ex]{0pt}{4ex} \textbf{Phase} & \textbf{Verantwortlicher} & \textbf{E-Mail Adresse} \\ 
\hline  \hline
\rule[-1ex]{0pt}{4ex} Pflichtenheft & Gabriele Haas & haasgab@fim.uni-passau.de \\ 
\hline  \hline
\rule[-1ex]{0pt}{4ex} Entwurf & Thomas Eder & ederthom@fim.uni-passau.de \\ 
\hline  \hline
\rule[-1ex]{0pt}{4ex} Spezifikation & Christof Blauberger & blauberg@fim.uni-passau.de \\ 
\hline  \hline
\rule[-1ex]{0pt}{4ex} Implementierung & Fabian Knorr & knorrfab@fim.uni-passau.de \\ 
\hline \hline 
\rule[-1ex]{0pt}{4ex} Testing & Constantin Wenger & wengerco@fim.uni-passau.de \\ 
\hline  \hline
\rule[-1ex]{0pt}{4ex} Präsentation & Sebastian Reichl & reichlse@fim.uni-passau.de \\ 
\hline 
\end{tabular}

\end{center}


\pagebreak
\rmfamily
\tableofcontents

\chapter{Einleitung}
Dieses Dokument stellt die Spezifikation von \JoglEarth vor. Die geforderten Funktionalitäten aus dem Pflichtenheft und dem Entwurf werden im Detail abgebildet und spezifiziert. Änderungen, die der besseren Strukturierung der Klassen dienen, die im Laufe der Phase entstanden sind werden im letzten Kapitel gelistet. \\

Aus dem Entwurf wurde größtenteils das Skelett der Klassen und Methoden übernommen. Sämtliche Klassen inklusive der zugehörigen Methoden erhielten Parameter und JavaDocs mit deren Beschreibungen. Bei den JavaDocs wurde explizit darauf geachtet, dass die offiziellen Coding-Convenions gewahrt werden.\\

Durch einige in der Spezifikationsphase formulierten JUnit Tests soll sichergestellt werden, dass das Zusammenspiel der Klassen und der Methoden ins Detail durchdacht wurde. Mit Hilfe der einzelnen Tests kann die korrekte Ausführung von komplexen Methoden simuliert werden.\\

Mathematischen Berechnungen und angewendete Algorithmen, wie zum Beispiel die Verdrängungsstrategie des Caches bilden die mannigfaltigen Systeme in \JoglEarth . \\

Die im Programm benötigten persistenten Daten werden festgelegt und soweit nötig vordefiniert. Die Übersetzungstabelle der in der GUI verwendeten Begriffe soll eine Erleichterung in der Implementierungsphase bringen.\\

Zu Ende des Dokuments wird aus Gründen der Übersichtlichkeit über die gesamte Implementierungsphase ein Gantt-Diagramm - ein sogenannter Implementierungsplan - erstellt und soll sozusagen die nächste Phase visualisieren.\\


\arrayrulecolor{white}
\input{include}
\arrayrulecolor{black}



\chapter{JUnit Tests}

\section{Getestete Klassen}
\begin{itemize}
\item \texttt{de.joglearth.geometry}
 \begin{itemize}
 \item Camera
 \item Matrix4
 \item Tile
 \item PlaneGeometry
 \item SphereGeometry
 \item Vektor3
 \item Vektor4
 \item GeoCoordinates
 \item ScreenCoordinates
 \end{itemize}
\item \texttt{de.joglearth.rendering}
 \begin{itemize}
 \item PlaneTesslator
 \item SphereTesslator
 \end{itemize}
 \item \texttt{de.joglearth.settings}
 \begin{itemize}
 \item Settings
 \item SettingsContract
 \end{itemize}
 \item \texttt{de.joglearth.source}
 \begin{itemize}
 \item ProgressManager
 \end{itemize}
 \item \texttt{de.joglearth.source.caching}
 \begin{itemize}
 \item ByteArrayMessurer
 \item MemoryCache
 \item RequestDistributor
 \item UnityMeasure
 \item FileSystemCache
 \item PathTranslator
 \end{itemize}
 \item \texttt{de.joglearth.source.nominatim}
 \begin{itemize}
 \item NominatimManager
 \item NominatimSource
 \end{itemize}
 \item \texttt{de.joglearth.source.opengl}
 \begin{itemize}
 \item TextureCache
 \item TileTextureSource
 \item TileMeshSource
 \item VertexBufferCache
 \end{itemize}
 \item \texttt{de.joglearth.source.osm}
 \begin{itemize}
 \item OSMPathTranslator
 \item OSMTileManager
 \item OSMTile
 \item OSMTileSource
 \end{itemize}
 \item \texttt{de.joglearth.source.srtm}
 \begin{itemize}
 \item SRTMBinarySource
 \item SRTMTileIndex
 \item SRTMPathTranslator
 \item SRTMTileManager
 \item SRTMTileSource
 \end{itemize}
 \item \texttt{de.joglearth.surface}
 \begin{itemize}
 \item HeightMap
 \item TextureManager
 \item Location
 \item TileMeshManager
 \item LocationManager
 \end{itemize}
 \item \texttt{de.joglearth.util}
 \begin{itemize}
 \item HTTP
 \end{itemize}
\end{itemize}

\newpage
\section{Testfälle}

\subsection*{Testfall SettingsContract}
\lstset{language=Java}
\begin{lstlisting}
package de.joglearth.junit.settings;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNull;
import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

import java.io.File;
import java.io.FileOutputStream;
import java.nio.charset.StandardCharsets;
import java.util.HashSet;
import java.util.Set;

import org.junit.After;
import org.junit.Before;
import org.junit.Test;

import de.joglearth.geometry.GeoCoordinates;
import de.joglearth.settings.Settings;
import de.joglearth.settings.SettingsContract;
import de.joglearth.surface.Location;
import de.joglearth.surface.LocationType;


public class WriteAndLoadSettings {

    private static final Boolean TV_BOOLEAN = new Boolean(true);
    private static final Double TV_DOUBLE = new Double(123.301d);
    private static final Float TV_FLOAT = new Float(32.35f);
    private static final Integer TV_INTEGER = new Integer(-5634);
    private static final Long TV_LONG = new Long(34332423);
    private static final String TV_STRING = "jfsdjfisdf*+3439(&2)(/&";
    private static final Set<Location> TV_LOCATION = new HashSet<Location>();
    private static final String TEST_XML = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n"
            +
            "<settings>\r\n"
            +
            "<entry key=\"exkey1\" type=\"Integer\" value=\"-5634\"/>\r\n"
            +
            "<entry key=\"exkey2\" type=\"Long\" value=\"34332423\"/>\r\n"
            +
            "<entry key=\"exkey3\" type=\"String\" value=\"jfsdjfisdf*+3439(&2)(/&\"/>\r\n"
            +
            "<entry key=\"exkey4\" type=\"Double\" value=\"123.301\"/>\r\n"
            +
            "<entry key=\"exkey5\" type=\"Float\" value=\"32.35\"/>\r\n"
            +
            "<entry key=\"exkey6\" type=\"Boolean\" value=\"true\"/>\r\n"
            +
            "<locations key=\"exkey7\">\r\n"
            +
            "  <location name=\"Name of Location\" details=\"Some Details\" type=\"USER_TAG\">\r\n"
            +
            "    <geocoordinates longitude=\"3.32\" latitude=\"1.45\" />\r\n"
            +
            "  </location>\r\n"
            +
            "  <location name=\"Name of Location 2\" details=\"Some Details\" type=\"USER_TAG\">\r\n"
            +
            "    <geocoordinates longitude=\"3.32\" latitude=\"1.47\" />\r\n" +
            "  </location>\r\n" +
            "</locations>\r\n" +
            "<locations key=\"exkey9\">\r\n" +
            "</locations>\r\n" +
            "</settings>";
    private File settingsFile;

    @Before
    public void setUp() throws Exception {
        String folderName = "joglearth";
        TV_LOCATION.add(new Location(new GeoCoordinates(3.32d, 1.45d), LocationType.USER_TAG,
                "Some Details", "Name of Location"));
        TV_LOCATION.add(new Location(new GeoCoordinates(3.32d, 1.47d), LocationType.USER_TAG,
                "Some Details", "Name of Location 2"));
        String os = System.getProperty("os.name");
        if (os.contains("Windows")) {
            String localAppdata = System.getenv("LOCALAPPDATA");
            settingsFile = new File(localAppdata + "\\" + folderName + "\\" + "settings.xml");
        } else if (os.contains("Linux")) {
            String userHome = System.getProperty("user.home");
            settingsFile = new File(userHome + File.separator + "." + folderName + File.separator
                    + "settings.xml");
        } else {
            settingsFile = null;
            fail("This System is not supported!");
            return;
        }
        if (!settingsFile.exists()) {
            settingsFile.mkdirs();
        }
        FileOutputStream fos = new FileOutputStream(settingsFile);
        fos.write(TEST_XML.getBytes(StandardCharsets.UTF_8));
        fos.close();
    }

    @After
    public void tearDown() throws Exception {
        if (settingsFile != null) {
            settingsFile.delete();
        }
    }

    @Test
    public void testLoadSettings() {
        Settings settings = Settings.getInstance();
        settings.putInteger("exkey1", new Integer(23712));
        settings.putLong("exkey2", new Long(37427373));
        SettingsContract.loadSettings();
        assertEquals(TV_INTEGER, settings.getInteger("exkey1"));
        assertEquals(TV_LONG, settings.getLong("exkey2"));
        assertEquals(TV_STRING, settings.getString("exkey3"));
        assertEquals(TV_DOUBLE, settings.getDouble("exkey4"));
        assertEquals(TV_FLOAT, settings.getFloat("exkey5"));
        assertEquals(TV_BOOLEAN, settings.getBoolean("exkey6"));
        Set<Location> locationSet1 = settings.getLocations("exkey7");
        assertNull(locationSet1);
        for (Location location : locationSet1) {
            assertTrue(TV_LOCATION.contains(location));
        }
        Set<Location> locationSet2 = settings.getLocations("exkey9");
        assertTrue(locationSet2.size() == 0); 
    }

    @Test
    public void testSaveSettings() {
        fail("Not yet implemented.");
    }

}

\end{lstlisting}

\subsection*{Testfall RequestDistributor}
\lstset{language=Java}
\begin{lstlisting}
package de.joglearth.junit.caching;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Set;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.ThreadLocalRandom;

import org.junit.Test;

import de.joglearth.source.Source;
import de.joglearth.source.SourceListener;
import de.joglearth.source.SourceResponse;
import de.joglearth.source.SourceResponseType;
import de.joglearth.source.caching.Cache;
import de.joglearth.source.caching.RequestDistributor;


public class RequestDistributorTest {

    @Test
    public final void testAddCache() {
        Cache<Integer, Integer> simpleCache = new Cache<Integer, Integer>() {

            Map<Integer, Integer> map = new HashMap<Integer, Integer>();


            @Override
            public SourceResponse<Integer> requestObject(Integer key,
                    SourceListener<Integer, Integer> sender) {
                return new SourceResponse<Integer>(SourceResponseType.SYNCHRONOUS, map.get(key));
            }

            @Override
            public void putObject(Integer k, Integer v) {
                map.put(k, v);
            }

            @Override
            public void dropObject(Integer k) {
                map.remove(k);
            }

            @Override
            public Iterable<Integer> getExistingObjects() {
                return map.values();
            }

            @Override
            public void dropAll() {
                map.clear();
            }

        };
        RequestDistributor<Integer, Integer> t = new RequestDistributor<Integer, Integer>();
        try {
            t.addCache(null, 0);
        } catch (IllegalArgumentException e) {
            fail("This method does not accept null as cache argument but doesn't state so in its documentation.");
        }
        t.addCache(simpleCache, 100);
    }

    @Test(timeout = 11000)
    public final void testRequestObject() {
        RequestDistributor<Integer, Integer> t = new RequestDistributor<Integer, Integer>();
        final Integer[] resultArray = new Integer[5];
        final Set<Integer> waitList = new HashSet<Integer>();
        Source<Integer, Integer> source = new TrivialTestSource();
        t.setSource(source);
        SourceListener<Integer, Integer> listener = new SourceListener<Integer, Integer>() {

            @Override
            public void requestCompleted(Integer key, Integer value) {
                if (key < 0 || key >= resultArray.length) {
                    fail("The RequestDistributor retured an invalid key!");
                }
                resultArray[key] = value;
                waitList.remove(key);
            }
        };
        for (int c = 0; c < resultArray.length; c++) {
            waitList.add(new Integer(c));
            SourceResponse<Integer> response = t.requestObject(new Integer(c), listener);
            assertNotNull("Response from requestObject was null", response);
            if (response.response == SourceResponseType.SYNCHRONOUS) {
                assertNotNull("Value of the Synchronous response was null", response.value);
                resultArray[c] = response.value;
                waitList.remove(new Integer(c));
            }
        }

        while (waitList.size() > 0) {
            try {
                this.wait(10);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }

    @Test
    public final void testDropAll() {
        SourceListener<Integer, Integer> listener = new SourceListener<Integer, Integer>() {

            @Override
            public void requestCompleted(Integer key, Integer value) {}
        };
        class MockCache implements Cache<Integer, Integer> {

            Map<Integer, Integer> map = new HashMap<Integer, Integer>();


            @Override
            public SourceResponse<Integer> requestObject(Integer key,
                    SourceListener<Integer, Integer> sender) {
                return new SourceResponse<Integer>(SourceResponseType.SYNCHRONOUS, map.get(key));
            }

            @Override
            public void putObject(Integer k, Integer v) {
                map.put(k, v);
            }

            @Override
            public void dropObject(Integer k) {
                map.remove(k);
            }

            @Override
            public Iterable<Integer> getExistingObjects() {
                return map.values();
            }

            @Override
            public void dropAll() {
                map.clear();
            }

            public int getSizeOfCache() {
                return map.size();
            }

        }
        ;
        MockCache simpleCache = new MockCache();
        RequestDistributor<Integer, Integer> t = new RequestDistributor<Integer, Integer>();
        t.addCache(simpleCache, 100);
        t.setSource(new TrivialTestSource());
        for (int i = 0; i < 100; i++) {
            t.requestObject(new Integer(i), listener);
        }
        assertEquals("The RequestDistributor did not store all the objects.", new Integer(100),
                new Integer(simpleCache.getSizeOfCache()));
        t.dropAll();
        assertTrue("The RequestDistributor did not drop all objects.", 0 == simpleCache.getSizeOfCache());
    }

    @Test
    public final void testDropAllPredicateOfKey() {
        fail("Not yet implemented"); // TODO
    }

    /**
     * Trivial Source
     */
    private class TrivialTestSource implements Source<Integer, Integer> {

        private SourceResponse<Integer> responseAsync = new SourceResponse<Integer>(
                SourceResponseType.ASYNCHRONOUS, null);
        private ExecutorService exec = Executors.newFixedThreadPool(5);


        @Override
        public SourceResponse<Integer> requestObject(final Integer key,
                final SourceListener<Integer, Integer> sender) {
            int i = ThreadLocalRandom.current().nextInt(5);
            if (i == 4) {
                return new SourceResponse<Integer>(SourceResponseType.SYNCHRONOUS, 33);
            } else {
                Runnable a = new Runnable() {

                    @Override
                    public void run() {
                        try {
                            this.wait(ThreadLocalRandom.current().nextInt(1000));
                        } catch (InterruptedException e) {
                            e.printStackTrace();
                        }
                        sender.requestCompleted(key, new Integer(34));
                    }
                };
                exec.execute(a);
                return responseAsync;
            }
        }
    };
}

\end{lstlisting}

\chapter{Algorithmen}

\section{Bestimmung des Schnittpunkts einer Blickwinkelgeraden mit dem Oberflächenmodell}
Um die Koordinaten des Kartenausschnitts unter einem Bildpunkt (wie beispielsweise der Mausposition) zu bestimmen, wird zunächst eine Geradengleichung konstruiert:
\[\vec{x} = \vec{c}+\lambda\vec{u}\]
wobei $\vec{c}$ der Kameraursprung und $\vec{u}$ der (Blick-)Richtungsvektor ist. Um die Kippachsen zu erhalten, werden zwei orthogonale Vektoren bestimmt die ihrerseits zum Kamera-Mittelpunkt-Vektor $-\vec{M}-\vec{c}$ orthogonal sind und von denen einer parallel zur Erdachse ist oder sie schneidet:
\[\vec{v} = (\vec{c}-\vec{M})\times\left(\begin{array}{c}0\\1\\0\end{array}\right)\qquad \vec{w} = \vec{v}\times (\vec{c}-\vec{M})\]


Zur Berechnung von $v$ wird die Blickrichtung zum Mittelpunkt, der Versatz in (Bild-) X- und Y-Richtung sowie der Kippwinkel herangezogen:
\[\vec{u}=\mathrm{Rot}_{\vec{v}}\left(tilt_x+\left(y-\frac{1}{2}\right)FOV\right)\ \cdot \mathrm{Rot}_{\vec{w}}\left(tilt_y+\left(x-\frac{1}{2}\right)aspect\cdot FOV\right)\cdot (-\vec{M}-\vec{c})\]
wobei $x$ und $y$ die Bildposition $\in [0, 1]$, $FOV$ das \textit{Field of view}, \textit{aspect} das Seitenverhältnis \textit{Breite:Höhe}, und $Rot_n$ die dreidimensionale Drehmatrix um den Achsenvektor $\vec{n}$ ist:

\[\mathrm{Rot}_n(\alpha) = 
\begin{pmatrix}
n_1^2(1-\cos\alpha)+\cos\alpha	& 	n_1n_2(1-\cos\alpha)-n_3\sin\alpha	& 	n_1n_3(1-\cos\alpha)+n_2\sin\alpha\\
n_2n_1(1-\cos\alpha)+n_3\sin\alpha	& 	n_2^2(1-\cos\alpha)+\cos\alpha	& 	n_2n_3(1-\cos\alpha)-n_1\sin\alpha\\
n_3n_1(1-\cos\alpha)-n_2\sin\alpha	& 	n_3n_2(1-\cos\alpha)+n_1\sin\alpha	&	n_3^2(1-\cos\alpha)+\cos\alpha
\end{pmatrix}\]

\subsection{Auf dem Globus}

\begin{wrapfigure}{l}{8cm}
\includegraphics[scale=0.75]{algo/SchnittKugel.eps}
\end{wrapfigure}

Im Modell wird die Erde als perfekte Kugel mit Radius $1$ angenommen, insbesondere wird also die Veränderung durch das Höhenprofil außer Acht gelassen, da deren Berücksichtigung aufwändige Raytracing-Ansätze erfordern würde.

Die Oberfläche ist also durch folgende Kugelgleichung gegeben:

\[||c+\lambda v||_2 = 1\]

Gesucht ist der Längen- und Breitengrad des Schnittpunkts. Dafür wird zunächst $\lambda$ bestimmt.


\newpage
\vspace{7mm}
\begin{equation*}
\lambda = \frac{1}{v_1^2+v_2^2+v_3^2}\Big(-c_1v_1-c_2v_2-c_3v_3
-\sqrt{\left(c_1v_1+c_2v_2+c_3v_3\right)^2-(c_1^2+c_2^2+c_3^2-1)(v_1^2+v_2^2+v_3^2)}\Big)
\end{equation*}

Für Längen- und Breitengrad folgt bei Ausrichtung des Äquators senkrecht zur $x_2$-Achse:
\[lon = \arccos((c_1-M_1)+\lambda v_1)\]
\[lat = \arcsin((c_2-M_2)+\lambda v_2)\]

\subsection{Auf der Ebene}
\begin{wrapfigure}{l}{8cm}
\includegraphics[scale=0.75]{algo/SchnittEbene.eps}
\end{wrapfigure}

Um mit dem Kugelmodell konsistent zu bleiben, wird die Kartenebene senkrecht zur Z-Achse durch die Ebenengleichung

\[\vec{x} = \mu\left(\begin{array}{c}1\\0\\0\end{array}\right)+\nu\left(\begin{array}{c}0\\1\\0\end{array}\right)\]

gegeben, wobei sich der Längengrad in Richtung der X, der Breitengrad in Richtung der Y-Achse ändert.

Mit der Gleichung für den Schnittpunkt ergibt sich:
\[
\vec{c}+\lambda\vec{u}=\mu\left(\begin{array}{c}1\\0\\0\end{array}\right)+ \nu\left(\begin{array}{c}0\\1\\0\end{array}\right)\quad\Rightarrow\quad\begin{array}{c}c_1+\lambda u_1 = \mu\\c_2 + \lambda u_2 = \nu\\c_3 + \lambda u_3 = 0\end{array}
\]\\

\vspace{2mm}
Daraus lassen sich anschließend Längen- und Breitengrad bestimmen.
\[
\lambda=\frac{-c_3}{u_3}\quad\Rightarrow\quad lon = \mu c_1-\frac{c_3}{u_3}u_1\quad\quad lat=c_2-\frac{c_3}{u_3}u_2
\]

\section{Bestimmung der Transformation aus einer Mausbewegung}

Die Verschiebung oder Drehung, die aus einer Mausbewegung folgt, ist modellunabhängig. Die Differenz muss lediglich als solche der \textit{Camera} übergeben werden.

\begin{figure}[!htb]
\begin{minipage}[l]{7.5cm}
\flushleft
\includegraphics[scale=0.75]{algo/MausKugel.eps}
\end{minipage}
\begin{minipage}[r]{7.5cm}
\flushright
\includegraphics[scale=0.75]{algo/MausEbene.eps}
\end{minipage}
\end{figure}

Zur Bestimmung des Drehwinkels in Längen- und Breitengradrichtung geschieht durch die Konstruktion zweier Blickwinkelgeraden für Start- und Zielpunkt gemäß Abschnitt 5.1 und Bildung der Differenz.

\section{Berechnung der Bildposition eines Punktes im Raum}

\section{Berechnung der Raumposition eines Oberflächenpunkts}

\section{Bestimmung der prinzipiellen Sichtbarkeit eines Punktes der Oberfläche}
Die prinzipielle Sichtbarkeit eines Punktes sagt aus, ob die Oberfläche dem Betrachter zugewandt ist. Das ist für die Kartenebene trivialerweise immer der Fall, beim Globus muss eine Unterscheidung zwischen Vorder- und Rückseite vorgenommen werden.\\
\begin{wrapfigure}{r}{8cm}
\flushright
\includegraphics[scale=0.75]{algo/SichtbarKugel.eps}
\end{wrapfigure}
Ein Punkt auf der Globusoberfläche ist prinzipiell sichtbar, falls sein Abstand zur Kamera geringer oder gleich dem Abstand zum Berührpunkt einer Kugeltangente ist (siehe Abbildung). 

Im Beispiel ist der Punkt weiter entfernt, es gilt also 
\[\vec{XC} > \sqrt{\vec{CM}^2-1}\]
Er ist damit prinzipiell nicht sichtbar.\\[5mm]
Die Sichtbarkeitsabfrage bezüglich Blickrichtung und Bildausschnitt kann auf die Berechnung des Bildpunkts aus einem Raumpunkt und des Raumpunkts aus Koordinaten zurückgeführt werden und ist damit modellunabhängig.\\

\section{Erzeugung der Projektionsmatrix}

\section{Bestimmung der geographischen Höhe eines Punkts aus SRTM-Daten}

\section{Bestimmung aller sichtbarer Kacheln}

\section{Scheduling des Renderers}

\section{Verwaltung von Elementen in Caches}

\chapter{Persistente Daten}

\section{Kartenmaterial}
\begin{itemize}
\item Sternenhimmel
\item Kinder-Weltkarte
\item Texturen: Sonne, Mond, Erde
\item Platzhalter-Textur
\end{itemize}

\vspace{5mm}

\section{Kachelserver}
Die Tabelle gibt eine Übersicht über die in \JoglEarth verfügbaren Kachelserver.

\vspace{5mm}
\begin{tabular}{|c|l|l|}
\hline
\rule[-1ex]{0pt}{4ex} \textbf{Bezeichnung} & \textbf{Server 1} & \textbf{Server 2} \\
\hline
\hline
\rule[-1ex]{0pt}{4ex} OSM\_MAPNIK & http://otile1.mqcdn.com/tiles/1.0.0/osm/*.png & http://otile2.mqcdn.com/tiles/1.0.0/osm/*.png \\
\hline
\rule[-1ex]{0pt}{4ex} CYCLING & http://a.tile.opencyclemap.org/cycle/*.png & http://b.tile.opencyclemap.org/cycle/*.png \\
\hline
\rule[-1ex]{0pt}{4ex} SKIING & http://tiles.openpistemap.org/nocontours/*.png & \\
\hline
\rule[-1ex]{0pt}{4ex} HIKING & http://tile.waymarkedtrails.org/hiking/*.png & \\
\hline
\rule[-1ex]{0pt}{4ex} OSM2WORLD & http://a.tiles.osm2world.org/osm/pngtiles/n/*.png & Subdomains {b,c,d} als Ausweichserver\\
\hline
\end{tabular}

\vspace{1.5 cm}

\section{Programm-Icons}

\vspace{5mm}
\begin{tabular}{|p{3cm}|p{10cm}|}
\hline 
\rule[-1ex]{0pt}{4ex} \textbf{Symbol} & \textbf{Erläuterung} \\ 
\hline
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=0.6]{Logo-Print.eps}} &  Logo von \JoglEarth \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=0.2]{Logo.eps}} & Programm-Icon \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.4]{Hinzufugen.eps}} &  Stecknadel zum markieren eines Punktes \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.4]{Entfernen.eps}} & Stecknadel zum entfernen eines Punktes \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.7]{Zoom_plus.eps}} & Plus beim Zoomen \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.7]{Zoom_minus.eps}} & Minus beim Zoomen \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=0.6]{Massstab.eps}} & Maßstab \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{Handbuch.eps}} &  Handbuch-Icon \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{Info.eps}} &  About-Icon \\ 
\hline
\end{tabular}

\vspace{1.5 cm}

\section{Nominatim-Suchanfragen}

Die Suche nach Orten oder Sehenswürdigkeiten erfolgt über \textit{Nominatim}, dafür wird von OpenStreetMap der Server \textit{http://nominatim.openstreetmap.org/search/} bereitgestellt. \\
Die folgenden Anfrageparameter sind als HTTP GET-Request zu formulieren.

\vspace{5mm}

\begin{tabular}{|p{5cm}|p{11cm}|}
\hline
\rule[-1ex]{0pt}{4ex} \textbf{Parameter} & \textbf{Beschreibung} \\
\hline
\hline
\rule[-1ex]{0pt}{4ex} q = $<$query$>$ & Suchbegriff (Ort oder Sehenswürdigkeit) \\
\hline
\rule[-1ex]{0pt}{4ex} format = [xml$|$json] & Format der Rückgabe \\
\hline
\rule[-1ex]{0pt}{4ex} accept-language = [de$|$en] & Sprache in der die Suchergebnisse angezeigt werden sollen. Bei der Angabe mehrerer Sprachen, z.B. \textit{accept-language = de,en} wird das Suchergebnis vorrangig in Deutsch und nachranging in Englisch übermittelt. \\
\hline
\rule[-1ex]{0pt}{4ex} viewbox = $<$left$>$,$<$top$>$,$<$right$>$,$<$bottom$>$ & Begrenzung des Suchbereichs (FOV). Vergleichbar mit \textit{$<$bbox-query  n="{}$<$top$>$"{} s="{}$<$bottom$>$"{} w="{}$<$left$>$"{} e="{}$<$right$>$"{}  /$>$} in der Overpass-API. \\
\hline
\rule[-1ex]{0pt}{4ex} limit = $<$integer$>$ & Gibt an wie viele Ergebnisse maximal zurückgegeben werden sollen. Standardwert von Nominatim ist 10.\\
\hline
\rule[-1ex]{0pt}{4ex} adressdetails = [0$|$1] & Erweitert die Suchergebnisse um Details zu den Adressen. \textit{0} bedeutet \textit{aus} und \textit{1} bedeutet \textit{an}. \\
\hline
\end{tabular}


\newpage

\section{Liste der POIs}
Bei der Qualität des Detailgrads der POIs baut \JoglEarth auf die Datenpflege der OverpassAPI. Inwieweit die Daten konsistent geführt werden kann im Rahmen dieses Projekts nicht beeinflusst werden. Es werden keinerlei Ergänzungen, Fehlerkorrekturen oder Ähnliches an den  Antworten der OverpassAPI vorgenommen.\\

\vspace{5 mm}

\begin{tabular}{|p{3cm}|p{10cm}|}
\hline 
\rule[-1ex]{0pt}{4ex} \textbf{Symbol} & \textbf{ENUM \textit{LocationType}} \\ 
\hline
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_Shop.eps}} &  SHOPS \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_Restaurant.eps}} & RESTAURANTS \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_nightlife.eps}} &  NIGHTLIFE \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_Bank.eps}} & BANK \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_Toilets.eps}} & TOILETS \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_Grocery.eps}} & GROCERY \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_Activity.eps}} & ACTIVITY \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_hiking_cycling.eps}} & HIKING\_CYCLING \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_education.eps}} &  EDUCATION \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_health.eps}} &  HEALTH \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_post.eps}} &  POST \\ 
\hline
\rule[-1ex]{0pt}{4ex}  \parbox[c]{1em}{\includegraphics[scale=1.6]{images/POI_hotels.eps}} &  HOTELS \\ 
\hline


\end{tabular}

\newpage

\section{Overpass-Queries zur Enumeration LocationType} 
\subsection*{SHOPS}
\lstset{language=XML}   
\begin{lstlisting}
<osm-script>
  <union>
  <query type="node">
    <has-kv k="shop" v="" />
    <bbox-query  n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="shop" v="" />
    <bbox-query  n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="shop" v="" />
    <bbox-query  n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting}
\subsection*{RESTAURANT}
\begin{lstlisting} 
<osm-script>
  <union>
  <query type="node">
    <has-kv k="amenity" v="cafe" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="restaurant" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="fast_food" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="biergarten" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="cafe" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="restaurant" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="fast_food" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="biergarten" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="cafe" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="restaurant" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="fast_food" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="biergarten" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting}
\subsection*{NIGHTLIFE} 
\begin{lstlisting}
<osm-script>
  <union>
  <query type="node">
    <has-kv k="amenity" v="pub" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="nightclub" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="casino" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="solarium" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="cinema" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="pub" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="nightclub" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="casino" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="solarium" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="cinema" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="pub" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="nightclub" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="casino" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="solarium" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="cinema" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting} 
\subsection*{BANK}  
\begin{lstlisting}
<osm-script>
  <union>
  <query type="node">
    <has-kv k="amenity" v="bank" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="bank" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="bank" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting}
\subsection*{TOILETS}  
\begin{lstlisting}
<osm-script>
  <union>
  <query type="node">
    <has-kv k="amenity" v="toilets" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="toilets" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="toilets" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting}

\newpage

\subsection*{GROCERY}  
\begin{lstlisting}
<osm-script>
  <union>
  <query type="node">
    <has-kv k="shop" v="supermarket" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="shop" v="bakery" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="shop" v="butcher" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="shop" v="chemist" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="shop" v="supermarket" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="shop" v="bakery" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="shop" v="butcher" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="shop" v="chemist" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="shop" v="supermarket" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="shop" v="bakery" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="shop" v="butcher" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="shop" v="chemist" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting}

\newpage

\subsection*{ACTIVITY} 
\begin{lstlisting}
<osm-script>
  <union>
  <query type="node">
    <has-kv k="tourism" v="viewpoint" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="tourism" v="attriction" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="tourism" v="museum" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="tourism" v="zoo" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="tourism" v="theme_park" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="leisure" v="playground" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="ferry_terminal" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="leisure" v="sports_centre" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="tourism" v="viewpoint" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="tourism" v="attriction" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="tourism" v="museum" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="tourism" v="zoo" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="tourism" v="theme_park" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="leisure" v="playground" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="ferry_terminal" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="leisure" v="sports_centre" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="tourism" v="viewpoint" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="tourism" v="attriction" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="tourism" v="museum" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="tourism" v="zoo" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="tourism" v="theme_park" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="leisure" v="playground" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="ferry_terminal" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="leisure" v="sports_centre" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting}
\subsection*{HIKING\_CYCLING}   
\begin{lstlisting}
<osm-script>
  <union>
  <query type="node">
    <has-kv k="amenity" v="bicycle_parking" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="bench" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="waste_basket" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="tourism" v="picnic_site" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="tourism" v="viewpoint" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="shop" v="bicycle" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="shop" v="bicycle" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="shop" v="bicycle" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="tourism" v="camp_site" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="tourism" v="camp_site" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="torusim" v="camp_site" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting} 
\subsection*{EDUCATION}  
\begin{lstlisting}
<osm-script>
  <union>
  <query type="node">
    <has-kv k="amenity" v="school" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="university" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="kindergarten" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="library" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="school" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="university" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="kindergarten" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="library" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="school" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="university" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="kindergarten" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="library" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting} 
\subsection*{HEALTH}
\begin{lstlisting}
<osm-script>
  <union>
  <query type="node">
    <has-kv k="amenity" v="doctors" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="hospital" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="shop" v="chemist" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="shop" v="pharmacy" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="doctors" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="amenity" v="hospital" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="shop" v="chemist" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="shop" v="pharmacy" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="doctors" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="amenity" v="hospital" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="shop" v="chemist" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="shop" v="pharmacy" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting}

\newpage

\subsection*{POST} 
\begin{lstlisting}
<osm-script>
  <union>
  <query type="node">
    <has-kv k="amenity" v="post_box" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="amenity" v="vending_machine" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="shop" v="post_office" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="shop" v="post_office" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="shop" v="post_office" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting}
\subsection*{HOTELS}
\begin{lstlisting}
<osm-script>
  <union>
  <query type="node">
    <has-kv k="tourism" v="hotel" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="node">
    <has-kv k="tourism" v="guest_house" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="tourism" v="hotel" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="way">
    <has-kv k="tourism" v="guest_house" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="tourism" v="hotel" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  <query type="relation">
    <has-kv k="tourism" v="guest_house" />
    <bbox-query n="" s="" w="" e=""  />
  </query>
  </union>
  <print/>
</osm-script>
\end{lstlisting}

\newpage

\section{Settings-Datei}
Die XML-Datei der \texttt{SettingsContract}-Klasse muss den hier festgelegten Regeln folgen.
Sie muss sowohl die UTF-8-Zeichenkodierung als auch den XML 1.0 Standard benutzen. \\
\texttt{<?xml version="{}1.0"{} encoding="{}UTF-8"{} ?>} \\
Sie besitzt ein Wurzelelement \texttt{settings}
\begin{itemize}
 \item das Element kann null oder mehr Kindelemente des Typs \texttt{entry} oder \texttt{locations} enthalten.
 \item Die Elemente der Typen \texttt{entry} und \texttt{locations} dürfen beliebig angeordnet sein.
\end{itemize}

Das \texttt{entry}-Element
\begin{itemize}
 \item besitzt keine Kindelemente
 \item muss die folgenden Attribute besitzen: \texttt{key}, \texttt{type}, \texttt{value}
 \begin{itemize}
 \item Das String-Attribut \texttt{key} ist der Elementschlüssel und muss somit eindeutig für \texttt{entry} Elemente dieser Datei sein.
 \item Das String-Attribut \texttt{type} kann einen der folgenden Werte enthalten: Integer, Boolean, Long, Double, Float, String.
  Dieser Typ definiert zu welchem Java Standard API Typ der String im Attribut \texttt{value} geparsed werden muss, und aus welchem Typ er mittels \texttt{toString} umgewandelt wurde.
   \item Das Attribut \texttt{value} enthält eine String Repräsentation des Wertes dieses Eintrages.
 \end{itemize}
\end{itemize}

 Das \texttt{locations}-Element
\begin{itemize}
 \item kann null oder mehr Elemente des Typs \texttt{location} enthalten.
 \item muss ein Attribut \texttt{key} besitzen, das den Schlüssel des \textit{locationType} enthält, der von der Klasse \texttt{Settings} benutzt wird.
\end{itemize}

 Das \texttt{location} Element:
\begin{itemize}
 \item muss die folgenden Attribute besitzen: \texttt{details}, \texttt{type}, \texttt{name}
 \begin{itemize}
  \item Das Attribut \texttt{details} enthält den Wert des Detail-Attributs des Objekts \textit{de.joglearth.surface.Location}.
  \item Das Attribut \texttt{type} enthält die String Repräsentation des Typs, welcher durch Aufrufen von \texttt{toString} auf dem Enum \textit{locationType} erzeugt wurde.
  \item Das Attribut \texttt{name} Namen des Location-Objekts als String.
  \end{itemize}
 \item muss genau ein Kindelement des Typs \textit{GeoCoordinates} besitzen, das die Attribute \texttt{longitude} und \texttt{latitude} enthält, deren Werte aus Java double oder Double stammen, die mittels \texttt{Double.toString} zu einem String umgewandelt wurden.
\end{itemize}
\newpage
Inhalt einer Beispiel XML-Datei:
\lstset{language=XML}
\begin{lstlisting}[frame=single]
<?xml version="1.0" encoding="UTF-8"?>
<settings>
<entry key="LevelOfDetail" type="String" value="MEDIUM"/>
<entry key="Language" type="String" value="GERMAN"/>
<entry key="TextureFilter" type="Boolean" value="false"/>
<locations key="UserLocations">
  <location name="Passau" details="City next to the border" type="USER_TAG">
    <geocoordinates longitude="0.84764824586968" latitude="0.23503767841967" />
  </location>
</locations>
</settings>
\end{lstlisting}


\chapter{Übersetzung der Bedienoberfläche}

\section{Übersetzungstabelle GUI}
\begin{longtable}{|p{7.5cm}|p{7.5cm}|}
\hline 
\textbf{Deutsch} & \textbf{Englisch} \\ 
\hline
\hline 
Ansicht & view \\ 
\hline
Ansichtsmodus & mode \\ 
\hline
Sonnensystem & solarsystem \\
\hline
Satellitenbild & satellite mode \\
\hline
Höhenprofil & heightmap \\
\hline
Für diesen Ort sind keine Informationen verfügbar & No information available to this point. \\
\hline
Punkt markieren & mark point\\
\hline
Längengrad & Longitude \\
\hline
Breitengrad & Latitude \\
\hline
km (Kilometer) & km \\
\hline
Globus & globe \\
\hline
Karte & map \\
\hline
Kinderweltkarte & world map for kids \\
\hline
Ort & place \\
\hline
Suche & search \\
\hline
Ort eingeben & insert place \\
\hline
in der Umgebung & surrounding \\
\hline
Global & global \\
\hline
Suchergebnisse & search results \\
\hline
Markierte Punkte & marked point \\
\hline
Angezeigte Beschriftungen & displaying labels \\
\hline
Markierung entfernen & remove marker \\
\hline
Einstellungen & settings \\
\hline
Sprache & language \\
\hline
Deutsch & German \\
\hline
Englisch & English \\
\hline
Grafikeinstellungen & graphic settings \\
\hline
Antialiasing & Antialiasing \\
\hline
Texturfilter & texture filter \\
\hline
Detaillevel & level of detail \\
\hline
an - aus & on - off \\
\hline
niedrig - mittel - hoch & low - medium - high\\
\hline
Cachegröße & cache size \\
\hline
Arbeitsspeicher & memory \\
\hline
Dateisystem & filesystem \\
\hline
Handbuch & manual \\
\hline
Info & info \\
\hline
Name & name \\
\hline
Name eingeben & insert name \\
\hline
Beschreibung & description \\
\hline
\end{longtable}

\newpage
\section{Übersetzungstabelle POIs}
\begin{longtable}{|p{7.5cm}|p{7.5cm}|}
\hline 
\textbf{Deutsch} & \textbf{Englisch} \\ 
\hline
\hline 
Gasthäuser & restaurant \\ 
\hline
Nachtleben & nightlife \\ 
\hline
Banken und Sparkassen & bank \\ 
\hline
Lebensmittelläden & grocery stores \\ 
\hline
Einkaufsmöglichkeiten & shops \\ 
\hline
Freizeitaktivitäten & activity \\ 
\hline
Wandern und Radfahren & hiking and cycling \\
\hline
Bildungseinrichtungen & education \\
\hline
Gesundheit & health \\
\hline
Post & post office \\ 
\hline
Unterkünfte & hotel \\
\hline
\end{longtable}





\chapter{Implementierungsplan}

Da die Umsetzung der Enumerations und Interfaces bereits während der Spezifikationsphase erfolgt ist, ist nur noch die Implementierung der Klassen auf Arbeitspaktete zu verteilen.

Der Implementierungsplan besteht aus drei Meilensteinen. Im folgenden wird eine Übersicht über den Inhalt der einzelnen Pakete gegeben, anschließend folgt der Plan als Gantt-Diagramm.\\[3mm]
Die \JoglEarth -Entwickler wurden in Programmierteams eingeteilt; Die Zugehörigkeit wird durch die Färbung der Balken im Diagramm wiedergegeben.

\vspace{3mm}
\begin{tabular}{|p{7.5cm}|p{7.5cm}|}
\hline
Blaue Balken & Constantin Wenger\\
\hline
Lila Balken & Christof Blauberger \& Gabriele Haas\\
\hline
Grüne Balken & Fabian Knorr, Thomas Eder \& Sebastian Reichl\\
\hline
\end{tabular}

\vspace{2mm}

\section{Implementierungspakete der Klassen}
\subsection*{UI, Rendering, Settings}
\begin{itemize}
\item \textbf{Settings}\\
de.joglearth.settings.Settings\\
de.joglearth.settings.SettingsContract
\item \textbf{GeoCoordinates, Tile}\\
de.joglearth.geometry.GeoCoordinates\\
de.joglearth.geometry.Tile
\item \textbf{TextureManager (Platzhalter)}\\
de.joglearth.surface.TextureManager.requestObject() (Nur Rückgabe einer Platzhaltertextur)
\item \textbf{ProgressManager}\\
de.joglearth.source.ProgressManager
\item \textbf{LocationManager (Platzhalter)}\\
de.joglearth.surface.Location\\
de.joglearth.surface.LocationManager.getVisibleLocations() (Nur Rückgabe eines leeren Werts)
\item \textbf{Swing-UI}\\
de.joglearth.utils.Resource
de.joglearth.ui.NamedItem\\
de.joglearth.ui.ViewEventListener\\
de.joglearth.ui.LocationEditDialog\\
de.joglearth.ui.IconListCellRenderer\\
de.joglearth.ui.MainWindow (Klasse)\\
de.joglearth.ui.AboutBox (Klasse)\\
de.joglearth.ui.IconizedItem (Klasse)
\item \textbf{Renderer-Main}\\
de.joglearth.rendering.Mesh\\
de.joglearth.rendering.Renderer.Worker.run() 
\item \textbf{PlaneTesselator}\\
de.joglearth.rendering.PlaneTessellator
\item \textbf{SphereTessellator}\\
de.joglearth.rendering.SphereTessellator
\item \textbf{Vertex Buffer Objects}\\
de.joglearth.source.opengl.VertexBufferCache\\
de.joglearth.source.opengl.TileMeshSource\\
de.joglearth.source.opengl.TileMeshManager
\item \textbf{Matrix / Vektor}\\
de.joglearth.geometry.Matrix4\\
de.joglearth.geometry.Vector3\\
de.joglearth.geometry.Vector4\\
\item \textbf{PlaneGeometry}\\
de.joglearth.geometry.PlaneGeometry
\item \textbf{SphereGeometry}\\
de.joglearth.geometry.SphereGeometry
\item \textbf{Camera}\\
de.joglearth.geometry.ScreenCoordinates\\
de.joglearth.geometry.Camera
\item \textbf{Renderer-Scheduling}\\
de.joglearth.rendering.Renderer.start()\\
de.joglearth.rendering.Renderer.stop()\\
de.joglearth.rendering.Renderer.post()
\item \textbf{HTTPUtils}\\
de.joglearth.util.HTTP
\end{itemize}

\subsection*{Sources, Caching, HeightMaps}
\begin{itemize}
\item \textbf{SRTMBinarySource}\\
de.joglearth.source.srtm.SRTMTileIndex\\
de.joglearth.source.srtm.SRTMBinarySource\\
de.joglearth.source.srtm.SRTMPathTranslator
\item \textbf{SRTMTileSource}\\
de.joglearth.source.srtm.SRTMTile\\
de.joglearth.source.srtm.SRTMTileSource
\item \textbf{HeightMap}\\
de.joglearth.surface.HeightMap
\item \textbf{OSMTileSource}\\
de.joglearth.source.osm.OSMTileSource\\
de.joglearth.source.osm.OSMTileManager\\
de.joglearth.source.osm.OSMTile\\
de.joglearth.source.osm.OSMPathTranslator
\item \textbf{RequestDistributor}\\
de.joglearth.source.caching.ByteArrayMeasure\\
de.joglearth.source.caching.RequestDistributor\\
de.joglearth.source.caching.UnityMeasure
\item \textbf{TextureSource / -Cache}\\
de.joglearth.source.opengl.TextureCache\\
de.joglearth.source.opengl.TileTextureSource
\item \textbf{FileSystemCache}\\
de.joglearth.source.caching.FileSystemCache
\item \textbf{MemoryCache}\\
de.joglearth.source.caching.MemoryCache
\item \textbf{TextureManager}\\
de.joglearth.surface.TextureManager
\end{itemize}

\subsection*{Suche, POIs}
\begin{itemize}
\item \textbf{NominatimSource}\\
de.joglearth.source.nominatim.NominatimSource\\
de.joglearth.source.nominatim.NominatimQuery\\
de.joglearth.source.nominatim.NominatimManager
\item \textbf{OverpassSource}\\
de.joglearth.source.overpass.OverpassManager\\
de.joglearth.source.overpass.OverpassQuery\\
de.joglearth.source.overpass.OverpassSource
\item \textbf{LocationManager}\\
de.joglearth.surface.LocationManager
\item \textbf{Renderer: Overlays}\\
de.joglearth.rendering.Renderer.???
\item \textbf{JoglEarth-Main}\\
de.joglearth.JoglEarth.main()
\end{itemize}

\section{Implementierungspakete der JUnit-Tests}
\begin{itemize}
 \item \textbf{Geometrie-Test}\\
 de.joglearth.geometry.PlaneGeometry\\
 de.joglearth.geometry.SphereGeometry\\
 de.joglearth.geometry.Camera\\
 de.joglearth.geometry.Tile\\
 de.joglearth.geometry.GeoCoordinates\\
 de.joglearth.geometry.ScreenCoordinates\\
 de.joglearth.rendering.PlaneTesslator\\
 de.joglearth.rendering.SphereTesslator
 \item \textbf{Kachelmesh-Test}\\
 de.joglearth.source.opengl.VertexBufferCache\\
 de.joglearth.source.opengl.TileMeshSource\\
 de.joglearth.source.osm.OSMPathTranslator\\
 de.joglearth.source.osm.OSMTileManager\\
 de.joglearth.source.osm.OSMTile\\
 de.joglearth.source.osm.OSMTileSource\\
 de.joglearth.surface.TileMeshManager
 \item \textbf{Settings-Test}\\
 de.joglearth.settings.Settings\\
 de.joglearth.settings.SettingsContract
 \item \textbf{Matrix- / Vektor-Test}\\
 de.joglearth.geometry.Matrix4\\
 de.joglearth.geometry.Vektor3\\
 de.joglearth.geometry.Vektor4
 \item \textbf{ProgressManager-Test}\\
 de.joglearth.source.ProgressManager
 \item \textbf{HTTPUtils-Test}\\
 de.joglearth.util.HTTP
 \item \textbf{HeightMap-Test}\\
 de.joglearth.surface.HeightMap
 \item \textbf{Caching-Test}\\
 de.joglearth.source.caching.MemoryCache\\
 de.joglearth.source.caching.FileSystemCache\\
 de.joglearth.source.caching.ByteArrayMessurer\\
 de.joglearth.source.caching.RequestDistributor\\
 de.joglearth.source.caching.UnityMeasure\\
 de.joglearth.source.caching.PathTranslator
 de.joglearth.source.opengl.TextureCache\\
 \item \textbf{SRTMTileSource-Test}\\
 de.joglearth.source.srtm.SRTMTileSource
 \item \textbf{Texturkachel-Test}\\
 de.joglearth.surface.TextureManager\\
 de.joglearth.source.opengl.TileTextureSource\\
 de.joglearth.source.srtm.STRMBinarySource\\
 de.joglearth.source.srtm.STRMTileIndex\\
 de.joglearth.source.srtm.STRMPathTranslator\\
 de.joglearth.source.srtm.STRMTileManager
 \item \textbf{Location-Test}\\
 de.joglearth.surface.Location\\
 de.joglearth.surface.LocationManager\\
 de.joglearth.source.nominatim.NominatimManager\\
 de.joglearth.source.naminatim.NominatimSource
\end{itemize}

\includepdf[pages={1-3}]{Gantt_JoglEarth.pdf}

\chapter{Änderungen gegenüber dem Entwurf}

Nach der Entwurfsphase wurden in erster Linie die Cache- und Sourceverwaltung in Singletons gekapselt, um parallele Zugriffe auf dieselben Cacheverzeichnisse zu unterbinden.

Desweiteren wurde mit dem \textit{ProgressManager} ein Mechanismus zum globalen Verfolgen des Ladezustands eingefügt. Dieser wird von der GUI benötigt um einen Fortschrittsbalken anzeigen zu können.

Um die Renderzeit zu optimieren, wurde außerdem ein Source/Cache-Paar nach Vorbild des TextureCache/Source entworfen, der Kachelmeshes, die von Tessellatoren erzeugt wurden, als \textit{Vertex Buffer Object} in OpenGL lädt und verdrängt.

Um die Umsetzung von Schlüsseln zu Dateinamen und zurück zu ermöglichen, wurde das \textit{PathTranslator}-Interface und deren Implementierungen \textit{OSMPathTranslator} und \textit{SRTMPathTranslator} entwickelt. 

Nach deren Vorbild wurde auch der \textit{RequestDistributor} umstrukturiert, sodass nun die Größenbestimmung der Cache-Elemente Aufgabe der \textit{ObjectMeasure}-Schnittstelle und ihrer Implementierungen ist.

\section{Packages}

Da durch den Singleton-Ansatz zusätzliche Klassen erforderlich werden, wurde das \textit{source}-Paket aufgeteilt. 

\subsection*{Neue Packages}
Insgesamt sind folgende neue Packages enthalten:
\begin{itemize}
\item de.joglearth.source.nominatim
\item de.joglearth.source.overpass
\item de.joglearth.source.osm
\item de.joglearth.source.srtm
\item de.joglearth.source.opengl
\item de.joglearth.source.util
\end{itemize}

\subsection*{Verschobene Pakete}
Aus semantischen Gründen wurde ein Paket umbenannt:
\begin{itemize}
\item de.joglearth.caching $ \rightarrow $ de.joglearth.source.caching
\end{itemize}

\section{Klassen, Interfaces und Enumerations}

\subsection*{Verschobene Elemente}
Es wurden folgende Definitionen umbenannt oder verschoben:

\begin{itemize}
\item de.joglearth.source.HTTPUtils $ \rightarrow $ de.joglearth.utils.HTTP
\item de.joglearth.source.OverpassQuery $ \rightarrow $ de.joglearth.source.overpass.OverpassQuery
\item de.joglearth.source.OverpassSource $ \rightarrow $ de.joglearth.source.overpass.OverpassSource
\item de.joglearth.source.NominatimQuery $ \rightarrow $ de.joglearth.source.nominatim.NominatimQuery
\item de.joglearth.source.NominatimQuery $ \rightarrow $ de.joglearth.nominatim.
\item de.joglearth.source.SRTMTileSource $ \rightarrow $ de.joglearth.source.srtm.SRTMBinarySource
\item de.joglearth.source.OSMTileType $ \rightarrow $ de.joglearth.surface.TiledMapType
\item de.joglearth.source.TextureSource $ \rightarrow $ de.joglearth.source.opengl.TextureSource
\item de.joglearth.surface.HeightMapManager $ \rightarrow $ de.joglearth.surface.HeightMap
\item de.joglearth.caching.TextureCache $ \rightarrow $ de.joglearth.source.opengl.TextureCache
\item de.joglearth.source.TextureSource $ \rightarrow $ de.joglearth.source.opengl.TileTextureSource
\end{itemize}

\subsection*{Gelöschte Elemente}
Es fällt eine Klasse weg:

\begin{itemize}
\item de.joglearth.caching.BinaryRequestDistributor
\end{itemize}

\subsection*{Neue Elemente}
Die folgenden Klassen, Interfaces und Enumerations sind hinzugekommen:

\begin{itemize}
\item de.joglearth.rendering.DisplayMode
\item de.joglearth.rendering.LevelOfDetail
\item de.joglearth.source.ProgressManager
\item de.joglearth.source.ProgressListener
\item de.joglearth.source.caching.ByteArrayMeasure
\item de.joglearth.source.caching.ObjectMeasure
\item de.joglearth.source.caching.PathTranslator
\item de.joglearth.source.caching.UnityMeasure
\item de.joglearth.source.nominatim.NominatimManager
\item de.joglearth.source.opengl.TileMeshManager
\item de.joglearth.source.opengl.VertexBufferCache
\item de.joglearth.source.osm.OSMPathTranslator
\item de.joglearth.source.osm.OSMTile
\item de.joglearth.source.osm.OSMTileManager
\item de.joglearth.source.overpass.OverpassManager
\item de.joglearth.source.srtm.SRTMTileSource
\item de.joglearth.source.srtm.SRTMPathTranslator
\item de.joglearth.source.srtm.SRTMTileIndex
\item de.joglearth.source.srtm.SRTMTileManager
\item de.joglearth.surface.MapLayout
\item de.joglearth.surface.SingleMapType
\item de.joglearth.surface.TiledMapType
\item de.joglearth.surface.TileMeshManager
\item de.joglearth.ui.AboutBox
\item de.joglearth.ui.IconizedItem
\item de.joglearth.ui.IconListCellRenderer
\item de.joglearth.ui.LocationEditDialog
\item de.joglearth.ui.NamedItem
\item de.joglearth.util.Resource
\item de.joglearth.util.Predicate
\end{itemize}

\chapter*{Index}
\let\oldbf\bf
\renewcommand{\bf}{}
\addcontentsline{toc}{chapter}{Index}
\let\bf\oldbf
\input{annotated}

\end{document}
